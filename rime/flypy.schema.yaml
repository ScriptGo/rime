# Rime schema
# encoding: utf-8

# æ–¹æ¡ˆè¯´æ˜
schema:
  schema_id: flypy
  name: å°é¹¤åŒæ‹¼
  description: |
    å°é¹¤åŒæ‹¼è‡ªå®šä¹‰æ–¹æ¡ˆ

# åŠŸèƒ½å¼€å…³
# states: æ–¹æ¡ˆé€‰å•æ˜¾ç¤ºçš„åç§°ã€‚å¯ä»¥æ³¨é‡Šæ‰ï¼Œä»å¯ä»¥é€šè¿‡å¿«æ·é”®åˆ‡æ¢ã€‚
# reset: é»˜è®¤çŠ¶æ€ã€‚ æ³¨é‡Šæ‰åï¼Œåˆ‡æ¢çª—å£æ—¶ä¸ä¼šé‡ç½®åˆ°é»˜è®¤çŠ¶æ€ã€‚
switches:
  - name: ascii_mode
    states: [ä¸­, En]
  # ä¸­è‹±æ ‡ç‚¹ç¬¦å·
  - name: ascii_punct
    states: [Â¥, $]
  # ç®€ç¹è¾“å…¥æ³•
  - name: traditionalization
    states: [ç®€ä½“, ç¹ä½“]
  # emoji
  - name: emoji
    states: ["ğŸˆšï¸ï¸\uFE0F", "ï¸ğŸˆ¶ï¸\uFE0E"]
    reset: 1
  # åŠè§’å…¨è§’ç¬¦å·
  - name: full_shape
    states: [åŠè§’, å…¨è§’]

# è¾“å…¥å¼•æ“
engine:
  processors:
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor

  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor

  translators:
    - punct_translator
    - script_translator
    # è‡ªå®šä¹‰çŸ­è¯­
    - table_translator@custom_phrase
    # æ—¶é—´ã€æ—¥æœŸã€æ˜ŸæœŸ
    - lua_translator@*date_translator
    # æ•°å­—ã€é‡‘é¢å¤§å†™
    - lua_translator@*number_translator
    # å†œå†
    - lua_translator@*lunar
    # Unicode
    - lua_translator@*unicode
    # è®¡ç®—å™¨
    - lua_translator@*calculator
    # æš´åŠ› GC
    - lua_translator@*force_gc

  filters:
    # é”™éŸ³é”™å­—æç¤º
    - lua_filter@*corrector
    # emoji
    - simplifier@emoji
    # ç®€ç¹åˆ‡æ¢
    - simplifier@traditionalize
    # å»é‡
    - uniquifier

###############################################################################
# speller
###############################################################################

speller:
  # å¦‚æœä¸æƒ³è®©ä»€ä¹ˆæ ‡ç‚¹ç›´æ¥ä¸Šå±ï¼Œå¯ä»¥åŠ åœ¨ alphabetï¼Œæˆ–è€…ç¼–è¾‘æ ‡ç‚¹ç¬¦å·ä¸ºä¸¤ä¸ªåŠä»¥ä¸Šçš„æ˜ å°„
  alphabet: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA`
  # å®šä¹‰ä»…ä½œä¸ºå§‹ç çš„æŒ‰é”®ï¼Œæ’é™¤ ` è®©å•ä¸ªçš„ ` å¯ä»¥ç›´æ¥ä¸Šå±
  initials: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA
  # ç¬¬ä¸€ä½<ç©ºæ ¼>æ˜¯æ‹¼éŸ³ä¹‹é—´çš„åˆ†éš”ç¬¦ï¼›ç¬¬äºŒä½<'>è¡¨ç¤ºå¯ä»¥æ‰‹åŠ¨è¾“å…¥å•å¼•å·æ¥åˆ†å‰²æ‹¼éŸ³ã€‚
  delimiter: " '"
  algebra:
    #  - erase/^xx$/
    #  - derive/^([jqxy])u$/$1v/
    #  - derive/^([aoe])([ioun])$/$1$1$2/
    #  - xform/^([aoe])(ng)?$/$1$1$2/
    #  - xform/iu$/Q/
    #  - xform/(.)ei$/$1W/
    #  - xform/uan$/R/
    #  - xform/[uv]e$/T/
    #  - xform/un$/Y/
    #  - xform/^sh/U/
    #  - xform/^ch/I/
    #  - xform/^zh/V/
    #  - xform/uo$/O/
    #  - xform/ie$/P/
    #  - xform/i?ong$/S/
    #  - xform/ing$|uai$/K/
    #  - xform/(.)ai$/$1D/
    #  - xform/(.)en$/$1F/
    #  - xform/(.)eng$/$1G/
    #  - xform/[iu]ang$/L/
    #  - xform/(.)ang$/$1H/
    #  - xform/ian$/M/
    #  - xform/(.)an$/$1J/
    #  - xform/(.)ou$/$1Z/
    #  - xform/[iu]a$/X/
    #  - xform/iao$/N/
    #  - xform/(.)ao$/$1C/
    #  - xform/ui$/V/
    #  - xform/in$/B/
    #  - xlit/QWRTYUIOPSDFGHJKLZXCVBNM/qwrtyuiopsdfghjklzxcvbnm/
    - erase/^xx$/
    - derive/^([jqxy])u$/$1v/
    - derive/^([aoe])([ioun])$/$1$1$2/
    - xform/^([aoe])(ng)?$/$1$1$2/
    - xform/iu$/â“†/
    - xform/(.)ei$/$1â“Œ/
    - xform/uan$/â“‡/
    - xform/[uv]e$/â“‰/
    - xform/un$/â“/
    - xform/^sh/â“Š/
    - xform/^ch/â’¾/
    - xform/^zh/â“‹/
    - xform/uo$/â“„/
    - xform/ie$/â“…/
    - xform/(.)i?ong$/$1â“ˆ/
    - xform/ing$|uai$/â“€/
    - xform/(.)ai$/$1â’¹/
    - xform/(.)en$/$1â’»/
    - xform/(.)eng$/$1â’¼/
    - xform/[iu]ang$/â“/
    - xform/(.)ang$/$1â’½/
    - xform/ian$/â“‚/
    - xform/(.)an$/$1â’¿/
    - xform/(.)ou$/$1â“/
    - xform/[iu]a$/â“/
    - xform/iao$/â“ƒ/
    - xform/(.)ao$/$1â’¸/
    - xform/ui$/â“‹/
    - xform/in$/â’·/
    - xlit/â“†â“Œâ“‡â“‰â“â“Šâ’¾â“„â“…â“ˆâ’¹â’»â’¼â’½â’¿â“€â“â“â“â’¸â“‹â’·â“ƒâ“‚/qwrtyuiopsdfghjklzxcvbnm/
    #- abbrev/^(.).+$/$1/ # é¦–å­—æ¯ç®€æ‹¼ï¼Œå¼€å¯åä¼šå¯¼è‡´ 3 ä¸ªå­—æ¯æ—¶ kj'x å˜æˆ k'jx çš„é—®é¢˜

###############################################################################
# translator
###############################################################################

translator:
  # æŒ‚è½½è¯åº“ extended_dict.yaml
  dictionary: extended
  # å¤šæ–¹æ¡ˆå…±ç”¨ä¸€ä¸ªè¯åº“æ—¶ï¼Œä¸ºé¿å…å†²çªï¼Œéœ€è¦ç”¨ prism æŒ‡å®šä¸€ä¸ªåå­—ã€‚
  prism: flypy
  # æƒé‡
  initial_quality: 1.2
  # æ˜¯å¦ä½¿ç”¨è¯­è¨€æ¨¡å‹ä¼˜åŒ–è¾“å‡ºç»“æœã€”éœ€é…åˆ grammar ä½¿ç”¨ã€•
  # contextual_suggestions: true
  # æœ€å¤§åŒéŸ³ç°‡é•¿åº¦ã€”éœ€é…åˆ grammar ä½¿ç”¨ã€•
  # max_homophones: 7
  # æœ€å¤§åŒå½¢ç°‡é•¿åº¦ã€”éœ€é…åˆ grammar ä½¿ç”¨ã€•
  # max_hompgraphs: 7
  # æ˜¯å¦å¼€å¯ç”¨æˆ·è¯å…¸ã€”ç”¨æˆ·è¯å…¸è®°å½•åŠ¨æ€å­—è¯é¢‘ã€ç”¨æˆ·è¯ã€•
  # enable_user_dict: true
  # æ˜¯å¦å¼€å¯è‡ªåŠ¨é€ å¥
  # enable_sentence: true
  # corrector.lua ï¼šä¸ºäº†è®©é”™éŸ³é”™å­—æç¤ºçš„ Lua åŒæ—¶é€‚é…å…¨æ‹¼åŒæ‹¼ï¼Œå°†æ‹¼éŸ³æ˜¾ç¤ºåœ¨ comment ä¸­
  spelling_hints: 8
  # corrector.lua ï¼šRime é»˜è®¤åœ¨ preedit ç­‰äº comment æ—¶å–æ¶ˆæ˜¾ç¤º commentï¼Œè¿™é‡Œå¼ºåˆ¶ä¸€ç›´æ˜¾ç¤ºï¼Œä¾› corrector.lua åšåˆ¤æ–­ç”¨ã€‚
  always_show_comments: true
  # æ ‡è®°æ‹¼éŸ³æ³¨é‡Šï¼Œä¾› corrector.lua åšåˆ¤æ–­ç”¨
  comment_format:
    - xform/^/ï¼»/
    - xform/$/ï¼½/
  # preedit_format å½±å“åˆ°è¾“å…¥æ¡†çš„æ˜¾ç¤ºå’Œâ€œShift+å›è½¦â€ä¸Šå±çš„å­—ç¬¦
  preedit_format:
    - xform/([bpmfdtnljqx])n/$1iao/
    - xform/(\w)g/$1eng/
    - xform/(\w)q/$1iu/
    - xform/(\w)w/$1ei/
    - xform/([dtnlgkhjqxyvuirzcs])r/$1uan/
    - xform/(\w)t/$1ve/
    - xform/(\w)y/$1un/
    - xform/([dtnlgkhvuirzcs])o/$1uo/
    - xform/(\w)p/$1ie/
    - xform/([jqx])s/$1iong/
    - xform/(\w)s/$1ong/
    - xform/(\w)d/$1ai/
    - xform/(\w)f/$1en/
    - xform/(\w)h/$1ang/
    - xform/(\w)j/$1an/
    - xform/([gkhvuirzcs])k/$1uai/
    - xform/(\w)k/$1ing/
    - xform/([jqxnlb])l/$1iang/
    - xform/(\w)l/$1uang/
    - xform/(\w)z/$1ou/
    - xform/([gkhvuirzcs])x/$1ua/
    - xform/(\w)x/$1ia/
    - xform/(\w)c/$1ao/
    - xform/([dtgkhvuirzcs])v/$1ui/
    - xform/(\w)b/$1in/
    - xform/(\w)m/$1ian/
    - xform/([aoe])\1(\w)/$1$2/
    - "xform/(^|[ '])v/$1zh/"
    - "xform/(^|[ '])i/$1ch/"
    - "xform/(^|[ '])u/$1sh/"
    - xform/([jqxy])v/$1u/
    - xform/([nl])v/$1Ã¼/
    - xform/Ã¼/v/ # Ã¼ æ˜¾ç¤ºä¸º v

# è‡ªå®šä¹‰çŸ­è¯­
custom_phrase:
  dictionary: ""
  # ç”¨æˆ·è¯å…¸(éœ€è¦æ‰‹åŠ¨åˆ›å»º)
  user_dict: custom_phrase
  # ç”¨æˆ·è¯å…¸ç±»å‹: tabledbã€”æ–‡æœ¬ã€•æˆ– userdbã€”äºŒè¿›åˆ¶ã€•
  db_class: stabledb
  # æ˜¯å¦å¼€å¯è‡ªåŠ¨é€ è¯
  enable_encoder: false
  # æå‰æ˜¾ç¤ºå°šæœªè¾“å…¥å®Œæ•´ç çš„å­—
  enable_completion: false
  # æ˜¯å¦å¯¹å·²ä¸Šå±›è¯è‡ªåŠ¨æˆè¯
  encode_commit_history: false
  # table_translator å‡ºå­—ä¼˜å…ˆçº§
  initial_quality: 99

# emoji
emoji:
  option_name: emoji
  opencc_config: emoji.json
  # åœ¨ corrector.lua åŠåæŸ¥ä¸­ï¼Œemoji è¿”å›ç©ºæ³¨é‡Š
  inherit_comment: false

# ç®€ç¹åˆ‡æ¢
traditionalize:
  option_name: traditionalization
  # s2t.json | s2hk.json | s2tw.json | s2twp.json
  opencc_config: s2t.json
  # è½¬æ¢æç¤º: all éƒ½æ˜¾ç¤º | char ä»…å•å­—æ˜¾ç¤º | none ä¸æ˜¾ç¤ºã€‚
  tips: none
  # é™åˆ¶åœ¨å¯¹åº” tagï¼Œä¸å¯¹å…¶ä»–å¦‚åæŸ¥çš„å†…å®¹åšç®€ç¹è½¬æ¢
  tags: [abc, number, gregorian_to_lunar]

###############################################################################
# è¯­è¨€æ¨¡å‹(https://github.com/amzxyz/RIME-LMDG)
###############################################################################

# grammar:
#   language: amz-v2n3m1-zh-hans
#   # æœ€å¤§æ­é…é•¿åº¦ï¼ˆæ•´å¥è¾“å…¥å¯å¿½ç•¥æ­¤é¡¹)
#   collocation_max_length: 5
#   # æœ€å°æ­é…é•¿åº¦ï¼ˆæ•´å¥è¾“å…¥å¯å¿½ç•¥æ­¤é¡¹ï¼‰
#   collocation_mix_length: 2

###############################################################################
# punctuator
###############################################################################

# punctuator ä¸‹é¢æœ‰ä¸‰ä¸ªå­é¡¹ï¼š
# full_shape å…¨è§’æ ‡ç‚¹æ˜ å°„
# half_shape åŠè§’æ ‡ç‚¹æ˜ å°„
# symbols    Rime çš„é¢„è®¾é…ç½®æ˜¯ä»¥ '/' å‰ç¼€å¼€å¤´è¾“å‡ºä¸€ç³»åˆ—å­—ç¬¦

# é¢„è®¾çš„ punctuation.yaml åŒ…å«äº† full_shape half_shape
# é¢„è®¾çš„ symbols.yaml     åŒ…å«äº† full_shape half_shape symbols
punctuator:
  # å¯¼å…¥è‡ªå®šä¹‰ç¬¦å·
  import_preset: symbols.custom
  symbols:
    "/emoji":
      [
        æ‰‹åŠ¿ï¼š/ss,
        åœ°çƒï¼š/dq,
        æ°´æœï¼š/sg,
        è¡¨æƒ…ï¼š/bq,
        emoï¼š/em,
        åŠ¨ç‰©ï¼š/da,
        å¤©æ°”ï¼š/tq,
        éŸ³ä¹ï¼š/yy,
      ]
    "/sym":
      [
        ç¬¦å·ï¼š/fh,
        æ ‡å¿—ï¼š/bz,
        ç”µè„‘ï¼š/dn,
        æ¸…å•ï¼š/td,
        èŠ‚æ°”ï¼š/jq,
        å•ä½ï¼š/dw,
        æ ‡ç‚¹ï¼š/bd,
        æ‹¼éŸ³ï¼š/py,
        è´§å¸ï¼š/hb,
      ]
    "/math":
      [
        æ•°å­¦ï¼š/sx,
        æ•°å­—ï¼š/0åˆ°/9,
        åˆ†æ•°ï¼š/fs,
        æ‹¬å·ï¼š/kh,
        æ˜Ÿå·ï¼š/xh,
        æ–¹å—ï¼š/fk,
        å‡ ä½•ï¼š/jh,
        ç®­å¤´ï¼š/jt,
        ç½—é©¬æ•°å­—ï¼š/lm,
        å¤§å†™ç½—é©¬æ•°å­—ï¼š/lmd,
        æ‹‰ä¸ï¼š/ld,
        ä¸Šæ ‡ï¼š/sb,
        ä¸‹æ ‡ï¼š/xb,
        å¸Œè…Šå­—æ¯ï¼š/xl,
        å¤§å†™å¸Œè…Šå­—æ¯ï¼š/xld,
      ]
  half_shape:
    "#": "#"
    "*": "*"
    "%": "%"
    "^": "^"
    "`": "`"
    "~": "~"
    "@": "@"
    "=": "="
    "/": ["/", "/", "Ã·"]
    "|": ["|", "ï½œ", "Â·", "ãƒ»", "Â§", "Â¦", "â€–", "ï¸´"]
    '\': "ã€"
    "_": "_"
    "'": { pair: ["ã€Œ", "ã€"] }
    "[": ["ã€", "ã€”", "ï¼»"]
    "]": ["ã€‘", "ã€•", "ï¼½"]
    "{": "{"
    "}": "}"
    "$": ["Â¥", "$", "â‚¬", "Â£", "Â¢", "Â¤"]
    "<": ["ã€Š", "ã€ˆ", "Â«", "<"]
    ">": ["ã€‹", "ã€‰", "Â»", ">"]

# å¿«æ·é”®
key_binder:
  # ä» default.yaml ç»§æ‰¿é€šç”¨çš„
  import_preset: default
  # ä¹Ÿå¯ä»¥å†å¢åŠ æ–¹æ¡ˆä¸“æœ‰çš„
  # bindings:

###############################################################################
# Lua é…ç½®
###############################################################################

# date_translator : å¿«é€Ÿè¾“å…¥æ—¥æœŸæ—¶é—´
date_translator:
  # æ—¥æœŸï¼š 2022-11-29
  date: date
  # æ—¶é—´ï¼š 18:13
  time: time
  # æ˜ŸæœŸï¼š æ˜ŸæœŸäºŒ
  week: week
  # ISO 8601ï¼š 2022-11-29T18:13:11+08:00
  datetime: datetime
  # æ—¶é—´æˆ³ï¼š 1669716794
  timestamp: timestamp

# lunar : å¿«é€Ÿè¾“å…¥å†œå†å¹´ä»½
# äºŒã€‡äºŒä¸‰å¹´å†¬æœˆäºŒå ç™¸å¯å¹´ï¼ˆå…”ï¼‰å†¬æœˆäºŒå
lunar: lunar

# corrector ï¼šä¸º corrector æ ¼å¼åŒ– commentï¼Œå ä½ç¬¦ä¸º {comment}
# é»˜è®¤ "{comment}" è¾“å…¥ hun dun æ—¶ä¼šåœ¨ã€Œé¦„é¥¨ã€æ—è¾¹ç”Ÿæˆ hÃºn tun çš„ comment
# ä¾‹å¦‚å·¦å³åŠ ä¸ªæ‹¬å· "({comment})" å°±ä¼šå˜æˆ (hÃºn tun)
corrector: "{comment}"

# calculator : è®¡ç®—å™¨è§¦å‘å…³é”®å­—
calculator:
  trigger: V

###############################################################################
# recognizer
###############################################################################

# å¤„ç†ç¬¦åˆç‰¹å®šè§„åˆ™çš„è¾“å…¥ç ï¼Œå¦‚ç½‘å€ã€åæŸ¥
recognizer:
  import_preset: default
  patterns:
    # åŒ¹é…è‡ªå®šä¹‰ç¬¦å·
    punct: "^/([0-9]0?|[A-Za-z]+)$"
    # åŒ¹é… e-mail
    email: "^[A-Za-z][-_.0-9A-Za-z]*@.*$"
    # åŒ¹é… URL
    url: "^(www[.]|https?:|ftp[.:]|mailto:|file:).*$|^[a-z]+[.].+$"
    # æ•°å­—é‡‘é¢å¤§å†™
    number: "^R[0-9]+[.]?[0-9]*"
    # å…¬å†è½¬å†œå†ï¼Œè¾“å…¥ N20240115 å¾—åˆ°ã€ŒäºŒã€‡äºŒä¸‰å¹´è…Šæœˆåˆäº”ã€
    gregorian_to_lunar: "^N[0-9]{1,8}"
    # Unicode
    unicode: "^U[a-f0-9]+"
    # è®¡ç®—å™¨
    calculator: "^V.*$"
